{% extends "finanzas/base.html" %}
{% load static %}
{% block content %}
<h1><i class="fa-solid fa-clock-rotate-left"></i> Historial de Movimientos</h1>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Fecha</th>
                <th>Usuario</th>
                <th>Tipo</th>
                <th>Periodo</th>
                <th>Columna</th>
                <th>Monto</th>
                <th>Observaciones</th>
                <th>Acción</th>
            </tr>
        </thead>
        <tbody>
            {% for mov in movimientos %}
            <tr>
                <td>{{ mov.fecha|date:"Y-m-d H:i" }}</td>
                <td>{% if mov.usuario %}{{ mov.usuario.username }}{% else %}Sistema{% endif %}</td>
                <td>{{ mov.tipo|capfirst }}</td>
                <td>{{ mov.periodo }}</td>
                <td>{{ mov.columna|default:"-" }}</td>
                <td>{{ mov.monto|default:"-" }}</td>
                <td style="text-align:left;">{{ mov.observaciones }}</td>
                <td>
                    <form method="POST">
                        {% csrf_token %}
                        <input type="hidden" name="id_mov" value="{{ mov.id }}">
                        <button type="submit" name="eliminar_mov" class="action-btn" onclick="return confirm('¿Eliminar este registro?')">
                            <i class="fas fa-trash-alt"></i> Eliminar
                        </button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="8">No hay movimientos registrados.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
